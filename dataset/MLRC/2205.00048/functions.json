{"functions": [{"paper_id": "2205.00048", "func_id": "0", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "II_F", "header_line": "4", "line_start": "5", "line_end": "15", "relevant_paper": "We refer to the expected exposure $\\mathsf{E}$\ncorresponding to a stochastic ranking policy $\\pi$ as determined by a\nretrieval system as *system exposure*. Similarly, *target exposure* is\ndefined as the expected exposure $\\mathsf{E}^*$ corresponding to an\nideal stochastic ranking policy $\\pi^*$, whose behavior may be dictated\nby some desirable principle, such as the *equal expected exposure\nprinciple*. The II-F metric, previously proposed by @diaz2020evaluating, measures\nthe disparity between the system and target exposure at the level of\nindividual users and individual items. Using similar notations as\nbefore, we have:\n\n$$\\begin{aligned}\n\\textbf{II-F} &=\\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{d\\in \\mathcal{D}}\\sum_{u\\in \\mathcal{U}}\\left(p(\\epsilon|d, u)-p^*(\\epsilon|d, u)\\right)^2 \\label{eqn:metric-iif1} \\\\\n&= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{i=1}^{|\\mathcal{U}|}(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})^2. \\label{eqn:metric-iif2}\n\\end{aligned}$$\n\nFor notational brevity, let\n$\\mathsf{E}^\\delta_{ij} = \\mathsf{E}_{ij}-\\mathsf{E}^\\sim_{ij}$ and\n$\\mathsf{E}^\\Delta_{ij} = \\mathsf{E}^*_{ij}-\\mathsf{E}^\\sim_{ij}$. Based\non [\\[eqn:metric-iif3\\]](#eqn:metric-iif3){reference-type=\"ref\"\nreference=\"eqn:metric-iif3\"}, we now redefine II-D and II-R as:\n\n$$\\begin{aligned}\n    \\textbf{II-D} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{i=1}^{|\\mathcal{U}|}{\\mathsf{E}^\\delta}_{ij}^2 \\label{eqn:metric-iid} \\\\\n    \\textbf{II-R} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{i=1}^{|\\mathcal{U}|}2{\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}. \\label{eqn:metric-iir}\n\\end{aligned}$$\n\n\\textbf{II-D} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{i=1}^{|\\mathcal{U}|}{\\mathsf{E}^\\delta}_{ij}^2\n\n\\textbf{II-R} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{U}|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{i=1}^{|\\mathcal{U}|}2{\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}"}, {"paper_id": "2205.00048", "func_id": "1", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "GI_F", "header_line": "18", "line_start": "19", "line_end": "56", "relevant_paper": "Next, we introduce group attributes on the user-side which gives us the\nGI-F metric that measures the over or under exposure of individual items\nto groups of users. Similar to the way we define the IG-F metric, the\nGI-F metric can be defined as follows, where $U \\in \\mathcal{G}_u$\ndenote a group of users and $\\mathcal{G}_u$ the set of all user groups:\n\n::: small\n$$\\begin{aligned}\n\\textbf{GI-F} &=\\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{d\\in \\mathcal{D}}\\sum_{U \\in \\mathcal{G}_u}\\left(p(\\epsilon|d, U)-p^*(\\epsilon|d, U)\\right)^2 \\label{eqn:metric-gif1} \\\\\n&= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{U\\in \\mathcal{G}_u}\\left(\\sum_{i=1}^{|U|}p(U_i|U)(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})\\right)^2. \\label{eqn:metric-gif2}\n\\end{aligned}$$\n:::\n\nConsequently, $p(U_i|U)$ can be defined as a uniform probability\ndistribution over all users in a group, or could be proportional to\ntheir usage of the recommender system.\n\n      \\textbf{GI-D} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{U\\in \\mathcal{G}_u}\\left(\\sum_{i=1}^{|U|}p(U_i|U){\\mathsf{E}^\\delta}_{ij}\\right)^2                                     \n\n\\textbf{GI-R} &= \\frac{1}{|\\mathcal{D}|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{j=1}^{|\\mathcal{D}|}\\sum_{U\\in \\mathcal{G}_u}\\left(\\sum_{i=1}^{|U|}2p(U_i|U){\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}\\right)^2"}, {"paper_id": "2205.00048", "func_id": "2", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "IG_F", "header_line": "59", "line_start": "60", "line_end": "85", "relevant_paper": "IG-F metric which is concerned with whether groups of items are over or\nunder exposed to individual users. We achieve this by making couple of\nminor modifications to\n[\\[eqn:metric-iif1\\]](#eqn:metric-iif1){reference-type=\"ref\"\nreference=\"eqn:metric-iif1\"}:\n\n::: enumerate*\nreplacing $p(\\epsilon|d, u)$ and $p^*(\\epsilon|d, u)$ with\n$p(\\epsilon|D, u)$ and $p^*(\\epsilon|D, u)$, respectively, where\n$D \\in \\mathcal{G}_d$ denotes a group of items and $\\mathcal{G}_d$ is\nthe set of all item groups, and\n\naveraging the deviations across groups of items instead of individual\nitems.\n:::\n\n::: small\n$$\\begin{aligned}\n\\textbf{IG-F} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{U}|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{u \\in \\mathcal{U}}\\left(p(\\epsilon|D, u)-p^*(\\epsilon|D, u)\\right)^2 \\label{eqn:metric-igf1} \\\\\n&= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{U}|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{i=1}^{|\\mathcal{U}|}\\left(\\sum_{j=1}^{|D|}p(D_j|D)(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})\\right)^2. \\label{eqn:metric-igf2}\n\\end{aligned}$$\n:::\n\nHere, $p(D_j|D)$ can be defined as a uniform probability distribution\nover all items in a group, or when appropriate a popularity weighted\ndistribution over items can also be employed.\n\n      \\textbf{IG-D} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{U}|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{i=1}^{|\\mathcal{U}|}\\left(\\sum_{j=1}^{|D|}p(D_j|D){\\mathsf{E}^\\delta}_{ij}\\right)^2\n\n\\textbf{IG-R} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{U}|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{i=1}^{|\\mathcal{U}|}\\left(\\sum_{j=1}^{|D|}2p(D_j|D){\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}\\right)^2"}, {"paper_id": "2205.00048", "func_id": "3", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "GG_F", "header_line": "88", "line_start": "89", "line_end": "127", "relevant_paper": "Having introduced group attributes for users and items separately, we\nnow change our focus to exposure disparities that emerge when we look at\ngroup attributes for both the users and items jointly. Using similar\nnotations as before, we can write:\n\n::: small\n$$\\begin{aligned}\n\\textbf{GG-F} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{U \\in \\mathcal{G}_u}\\left(p(\\epsilon|D,U)-p^*(\\epsilon|D,U)\\right)^2 \\label{eqn:metric-ggf1} \\\\\n&= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{U \\in \\mathcal{G}_u}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|U|} p(D_j|D) p(U_i|U)(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})\\right)^2. \\label{eqn:metric-ggf2}\n\\end{aligned}$$\n:::\n\nOf all six fairness metrics defined in this section, the GG-F metric is\nparticularly interesting as all the other metrics can be thought of\nspecific instances of GG-F. For example, if we define the group\nattributes for users in GG-F such that each group contains only one user\nand every user belongs to only one group then we recover the IG-F\nmetric. A similar trivial definition of groups on the item-side gives us\nthe GI-F metric. Consequently, if this trivial definition of groups is\napplied to both the users and items, we get the II-F metric. Another\ntrivial, but conceptually interesting, definition of the user group may\ninvolve a single group to which all users belong. Under this setting,\ndepending on group definition on the item-side, we can recover the AI-F\nand AG-F metrics that we describe next.\n\n      \\textbf{GG-D} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{U \\in \\mathcal{G}_u}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|U|} p(D_j|D)  p(U_i|U){\\mathsf{E}^\\delta}_{ij}\\right)^2\n\n\\textbf{GG-R} &= \\frac{1}{|\\mathcal{G}_d|}\\frac{1}{|\\mathcal{G}_u|}\\sum_{D \\in \\mathcal{G}_d}\\sum_{U \\in \\mathcal{G}_u}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|U|} 2  p(D_j|D)  p(U_i|U){\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}\\right)^2"}, {"paper_id": "2205.00048", "func_id": "4", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "AI_F", "header_line": "130", "line_start": "131", "line_end": "149", "relevant_paper": "A recommender system may systemically under or over expose an item to\nall users. To quantify this kind of systemic disparities we define the\nAI-F metric which computes the mean deviation between overall system\nexposure $p(\\epsilon|d)$ and target exposure $p^*(\\epsilon|d)$ for\nitems:\n\n::: small\n$$\\begin{aligned}\n\\textbf{AI-F} &= \\frac{1}{|\\mathcal{D}|}\\sum_{d \\in \\mathcal{D}}\\left(p(\\epsilon|d)-p^*(\\epsilon|d)\\right)^2 \\label{eqn:metric-aif1} \\\\\n&= \\sum_{j=1}^{|\\mathcal{D}|}\\left(\\sum_{i=1}^{|\\mathcal{U}|} p(\\mathcal{U}_i)(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})\\right)^2. \\label{eqn:metric-aif2}\n\\end{aligned}$$\n:::\n\nAs earlier, $p(\\mathcal{U}_i)$ can either be uniform or weighted by\nusage.\n\n      \\textbf{AI-D} &= \\sum_{j=1}^{|\\mathcal{D}|}\\left(\\sum_{i=1}^{|\\mathcal{U}|} p(\\mathcal{U}_i){\\mathsf{E}^\\delta}_{ij}\\right)^2                                                                                           \n\n\\textbf{AI-R} &= \\sum_{j=1}^{|\\mathcal{D}|}\\left(\\sum_{i=1}^{|\\mathcal{U}|} 2 p(\\mathcal{U}_i){\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}\\right)^2"}, {"paper_id": "2205.00048", "func_id": "5", "file": "src/utils/evaluation_functions/fairness_metrics.py", "name": "AG_F", "header_line": "152", "line_start": "153", "line_end": "177", "relevant_paper": "Finally, the AG-F metric is concerned with systemic under or over\nexposure of groups of items to all users and is defined as follows:\n\n::: small\n$$\\begin{aligned}\n\\textbf{AG-F} &= \\frac{1}{|\\mathcal{G}_d|}\\sum_{D \\in \\mathcal{G}_d}\\left(p(\\epsilon|D)-p^*(\\epsilon|D)\\right)^2 \\label{eqn:metric-agf1} \\\\\n&= \\frac{1}{|\\mathcal{G}_d|}\\sum_{D \\in \\mathcal{G}_d}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|\\mathcal{U}|} p(D_j|D)  p(\\mathcal{U}_i)(\\mathsf{E}_{ij}-\\mathsf{E}^*_{ij})\\right)^2. \\label{eqn:metric-agf2}\n\\end{aligned}$$\n:::\n\n      \\textbf{AG-D} &= \\frac{1}{|\\mathcal{G}_d|}\\sum_{D \\in \\mathcal{G}_d}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|\\mathcal{U}|} p(D_j|D)  p(\\mathcal{U}_i){\\mathsf{E}^\\delta}_{ij}\\right)^2\n\n\\textbf{AG-R} &= \\frac{1}{|\\mathcal{G}_d|}\\sum_{D \\in \\mathcal{G}_d}\\left(\\sum_{j=1}^{|D|}\\sum_{i=1}^{|\\mathcal{U}|} 2 p(D_j|D)  p(\\mathcal{U}_i){\\mathsf{E}^\\delta}_{ij}{\\mathsf{E}^\\Delta}_{ij}\\right)^2"}, {"paper_id": "2205.00048", "func_id": "6", "file": "src/utils/evaluation_functions/stochastic.py", "name": "eval_function_stochas", "header_line": "10", "line_start": "11", "line_end": "44", "relevant_paper": ""}, {"paper_id": "2205.00048", "func_id": "7", "file": "src/utils/evaluation_functions/static.py", "name": "eval_function_static", "header_line": "9", "line_start": "10", "line_end": "34", "relevant_paper": ""}]}